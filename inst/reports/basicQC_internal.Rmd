### QC report for `r data_set_name`

A series of plots showing the sequence quality and data. More to be written
here soon.

```{r}
seq_df <- result$metrics[[data_set_name]]$seq_df
zone_qual <- result$metrics[[data_set_name]]$zone_qual
fig.cap1 <- "Histograms of read lengths and average qualities"
fig.cap2 <- "Read length and quality by position on slide"
```

```{r, dpi=300, fig.width=7, fig.height=7, fig.cap=fig.cap1}
options(scipen=99)
read_width_breaks <- c(-Inf,(0:22)*15, Inf)
qual_breaks <- (0:21)*2
p1 <- 
ggplot(seq_df, aes(x=read_widths)) + 
  geom_histogram(breaks=read_width_breaks) +
  xlab('Read Length') +
  ylab('Number of Reads')
p2 <- 
ggplot(seq_df, aes(x=qual)) + 
  geom_histogram(breaks=qual_breaks) +
  xlab('Quality Score') +
  ylab('Number of Reads')
grid.arrange(p1, p2, ncol=2)
```

```{r, dpi=300, fig.width=7, fig.height=7, fig.cap=fig.cap2}
p3 <-
ggplot(zone_qual,
       aes(x=xcat, y=ycat, fill=n_seq)) + 
       geom_tile() + 
       theme(legend.position = 'bottom') +
       xlab(NULL) + ylab(NULL) +
       labs(list(fill = 'Number of Sequences'))
p4 <-
ggplot(zone_qual,
       aes(x=xcat, y=ycat, fill=zone_quality)) + 
       geom_tile() + 
       theme(legend.position = 'bottom') +
       xlab(NULL) + ylab(NULL) +
       labs(list(fill = 'Average Quality Score'))
grid.arrange(p3, p4, ncol=2)
```
