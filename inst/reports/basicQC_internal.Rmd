### QC report for `r data_set_name`

A series of plots showing the sequence quality and data. More to be written
here soon.

```{r}
#seq_dat <- result$final[[data_set_name]]
#
#fastq_name_headers <- c("instrument", "run_num", "flowcell", "lane", "tile",
#                        "xpos", "ypos", "read", "is_filtered", "control_num",
#                        "index_seq")
#fastq_numeric <- c("run_num", "lane", "tile", "xpos", "ypos", "read",
#                   "control_num", "index_seq")
#
#per_read_quality <- letterFrequency(seq_dat@quality@quality, 
#                                    names(encoding(seq_dat@quality)))
#per_read_quality <- (per_read_quality %*% matrix(encoding(seq_dat@quality), ncol=1))[,1]
#
#seq_df <- data.frame(seq_name = as.character(seq_dat@id),
#                     read_widths = width(seq_dat),
#                     qual = per_read_quality / width(seq_dat),              
#                     stringsAsFactors = F)
#rm(per_read_quality)
#
#seq_df <- seq_df %>%
#  mutate(seq_name = gsub(' ', ':', seq_name)) %>%
#  separate(seq_name, fastq_name_headers, ":") %>%
#  mutate_each_(funs(as.numeric), fastq_numeric) %>%
#  mutate(xcat = round(xpos/max(xpos), 2)) %>%
#  mutate(ycat = round(ypos/max(ypos), 2))
#
#zone_qual <- seq_df %>%
#  group_by(xcat, ycat) %>%
#  summarize(zone_quality = mean(qual, na.rm=T),
#            n_seq = sum(!is.na(qual)))
```

```{r}
seq_df <- result$metrics[[data_set_name]]$seq_df
zone_qual <- result$metrics[[data_set_name]]$zone_qual
```


```{r}
hist(seq_df$read_widths)
```
```{r}
hist(seq_df$qual)
```
```{r}
print(
ggplot(zone_qual,
       aes(x=xcat, y=ycat, fill=n_seq)) + 
       geom_tile()
       )
```
```{r}
print(
ggplot(zone_qual,
       aes(x=xcat, y=ycat, fill=zone_quality)) + 
       geom_tile()
       )
```
